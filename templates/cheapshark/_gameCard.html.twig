<div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden group">
    {# Image container #}
    <div class="relative overflow-hidden aspect-[16/9] w-full">
        <a href="{{ path('app_cheapshark_game', {'gameID': game.gameID, 'dealID': game.dealID}) }}">
            <img src="{{ game.thumb }}" alt="{{ game.title }}"
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" />
        </a>

        {% if game.savings <= 0 %} {% set isOnSale=false %} {% else %} {% set isOnSale=true %} {# Discount badge #}
            <span class="absolute top-2 left-2 bg-red-600 text-white rounded-md px-2 py-1 font-semibold">
            -{{ game.savings|round(0) }}%
            </span>
            {% endif %}

            {# Platform badge #}
            <span class="absolute top-2 right-2 bg-gray-50 rounded-md px-2 py-1 font-semibold">
                {{ app.session.get('stores')[game.storeID] }}
            </span>
    </div>

    {# Content #}
    <div class="p-4">
        <h3 class="font-medium text-gray-900 mb-2 line-clamp-2 min-h-[3rem]">
            {{ game.title }}
        </h3>

        {# Rating #}
        <div class="flex items-center gap-1 mb-3">
            {% if game.note %}
            <div class="flex">
                {% for i in 1..5 %}
                {% if i <= game.note %} <i class="fa-solid fa-star text-yellow-400"></i>
                    {% else %}
                    <i class="fa-regular fa-star text-gray-300"></i>
                    {% endif %}
                    {% endfor %}
            </div>
            <span class="text-sm text-gray-600 ml-1">
                ({{ game.note }}/5)
            </span>
            {% else %}
            <p class="text-gray-400">{{'gamecard.unavailable_note'|trans}}</p>
            {% endif %}
        </div>

        {# Price #}
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-2">
                {% if isOnSale %}
                <span class="text-lg font-bold text-blue-600">
                    {% if game.salePrice <= 0 %} {{'gamecard.free'|trans}} {% else %} {{ game.salePrice }}€ {% endif %} </span>
                        <span class="text-sm text-gray-500 line-through">
                            {{ game.normalPrice }}€
                        </span>
                        {% else %}
                        <span class="text-lg font-bold text-gray-900">
                            {{ game.normalPrice }}€
                        </span>
                        {% endif %}
            </div>
        </div>

        {# Add to cart button #}
        <a href="{{ path('app_cart_add') }}?id={{ game.dealID|url_encode }}"
            class="w-full block text-center bg-blue-600 hover:bg-blue-700 text-white rounded-md py-2">
            <i class="fa-solid fa-cart-shopping"></i>
            {{'gamecard.add_to_cart'|trans}}
        </a>
    </div>
</div>