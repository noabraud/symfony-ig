<div class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden group">
    {# Image container #}
    <div class="relative overflow-hidden aspect-[16/9] w-full">
        <img src="{{ game.thumb }}" alt="{{ game.title }}"
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" />

        {% if game.savings <= 0 %} {% set isOnSale=false %} {% else %} {% set isOnSale=true %} {# Discount badge #}
            <span class="absolute top-2 left-2 bg-red-600 text-white rounded-md px-2 py-1 font-semibold">
            -{{ game.savings|round(0) }}%
            </span>
            {% endif %}

            {# Platform badge #}
            <span class="absolute top-2 right-2 bg-gray-50 rounded-md px-2 py-1 font-semibold">
                {{ app.session.get('stores')[game.storeID] }}
            </span>
    </div>

    {# Content #}
    <div class="p-4">
        <h3 class="font-medium text-gray-900 mb-2 line-clamp-2 min-h-[3rem]">
            {{ game.title }}
        </h3>

        {# Rating #}
        <div class="flex items-center gap-1 mb-3">
            {% if game.metacriticScore and game.steamRatingPercent %}
            {% set rating = ((game.metacriticScore + game.steamRatingPercent) / 2 / 20)|round(0) %}
            {% elseif game.metacriticScore and not game.steamRatingPercent %}
            {% set rating = (game.metacriticScore / 20)|round(0) %}
            {% elseif not game.metacriticScore and game.steamRatingPercent %}
            {% set rating = (game.steamRatingPercent / 20)|round(0) %}
            {% else %}
            {% set rating = false %}
            {% endif %}

            {% if rating %}
            <div class="flex">
                {% for i in 1..5 %}
                {% if i <= rating %} <i class="fa-solid fa-star text-yellow-400"></i>
                    {% else %}
                    <i class="fa-regular fa-star text-gray-300"></i>
                    {% endif %}
                    {% endfor %}
            </div>
            <span class="text-sm text-gray-600 ml-1">
                ({{ rating }}/5)
            </span>
            {% else %}
            <p class="text-gray-400">Note indisponible</p>
            {% endif %}
        </div>

        {# Price #}
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-2">
                {% if isOnSale %}
                <span class="text-lg font-bold text-blue-600">
                    {% if game.salePrice <= 0 %} FREE {% else %} {{ game.salePrice }}€ {% endif %} </span>
                        <span class="text-sm text-gray-500 line-through">
                            {{ game.normalPrice }}€
                        </span>
                        {% else %}
                        <span class="text-lg font-bold text-gray-900">
                            {{ game.normalPrice }}€
                        </span>
                        {% endif %}
            </div>
        </div>

        {# Add to cart button #}
        <button class="w-full bg-blue-600 hover:bg-blue-700 text-white rounded-md py-2">
            <i class="fa-solid fa-cart-shopping"></i>
            Ajouter au panier
        </button>
    </div>
</div>